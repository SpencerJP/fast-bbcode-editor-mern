{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/redux-mern-landing/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/var/www/redux-mern-landing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/var/www/redux-mern-landing/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/var/www/redux-mern-landing/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n\\tfont-size: 16px;\\n\\tline-height: 2em;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n\\tmax-width: 35px;\\n\\theight: auto;\\n\\tfloat: left;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n\\t&&& {\\n\\t\\tbackground-color: #7289da;\\n\\t\\tcolor: #fff;\\n\\t\\tmin-height: 40px;\\n\\t\\tmin-width: 160px;\\n\\t}\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n\\t&&&&&& {\\n\\t\\tborder-radius: 50%;\\n\\t\\tmax-width: 40px;\\n\\t\\theight: auto;\\n\\t\\t// margin-left: 6em;\\n\\t}\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React from\"react\";import{Button,Image,Grid,Icon}from\"semantic-ui-react\";import{useSelector,useDispatch}from\"react-redux\";import{useCookies}from\"react-cookie\";import styled from\"styled-components\";import{getDiscordUserObject,deleteDiscordUserObject}from\"../../redux/actions/discordApiActions\";var Avatar=styled(Image)(_templateObject());var LoginLogoutButton=styled(Button)(_templateObject2());var DiscordLogo=styled.img(_templateObject3());var TextAlignment=styled.span(_templateObject4());export default function DiscordAuth(){var user=useSelector(function(state){return state.discordReducer.discordUserObject;});var dispatch=useDispatch();var _useCookies=useCookies([\"discord_token\"]),_useCookies2=_slicedToArray(_useCookies,3),cookies=_useCookies2[0],removeCookie=_useCookies2[2];React.useEffect(function(){function getDiscordUser(){return _getDiscordUser.apply(this,arguments);}function _getDiscordUser(){_getDiscordUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var dToken,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dToken=cookies.discord_token;if(!dToken){_context.next=9;break;}_context.next=4;return fetch(\"https://discordapp.com/api/users/@me\",{headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(dToken)}});case 4:response=_context.sent;_context.next=7;return response.json();case 7:data=_context.sent;dispatch(getDiscordUserObject(data));case 9:case\"end\":return _context.stop();}}},_callee);}));return _getDiscordUser.apply(this,arguments);}try{getDiscordUser();}catch(err){console.error(err);}},[cookies.discord_token,dispatch]);if(user){return React.createElement(React.Fragment,null,React.createElement(Grid.Column,{style:{minWidth:\"160px\"}},React.createElement(LoginLogoutButton,{color:\"blue\",onClick:function onClick(){removeCookie(\"discord_token\");dispatch(deleteDiscordUserObject());}},React.createElement(DiscordLogo,{src:\"https://discordapp.com/assets/1c8a54f25d101bdc607cec7228247a9a.svg\",alt:\"discord icon\"}),React.createElement(TextAlignment,null,\"Logout\"))),React.createElement(Grid.Column,{width:2,style:{textAlign:\"center\"}},React.createElement(Avatar,{className:\"discord-avatar\",id:\"avatar\",src:\"http://cdn.discordapp.com/avatars/\".concat(user.id,\"/\").concat(user.avatar,\".png\")})));}else{return React.createElement(LoginLogoutButton,{color:\"blue\",href:window.REACT_APP_URL+\"/api/discord/login/\"},React.createElement(DiscordLogo,{src:\"https://discordapp.com/assets/1c8a54f25d101bdc607cec7228247a9a.svg\",alt:\"discord icon\"}),React.createElement(TextAlignment,null,\"Login\"));}}","map":{"version":3,"sources":["/var/www/redux-mern-landing/server/client/src/components/common/DiscordAuth.jsx"],"names":["React","Button","Image","Grid","Icon","useSelector","useDispatch","useCookies","styled","getDiscordUserObject","deleteDiscordUserObject","Avatar","LoginLogoutButton","DiscordLogo","img","TextAlignment","span","DiscordAuth","user","state","discordReducer","discordUserObject","dispatch","cookies","removeCookie","useEffect","getDiscordUser","dToken","discord_token","fetch","headers","Authorization","response","json","data","err","console","error","minWidth","textAlign","id","avatar","window","REACT_APP_URL"],"mappings":"2yCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,MAAT,CAAiBC,KAAjB,CAAwBC,IAAxB,CAA8BC,IAA9B,KAA0C,mBAA1C,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,UAAT,KAA2B,cAA3B,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OACCC,oBADD,CAECC,uBAFD,KAGO,uCAHP,CAKA,GAAMC,CAAAA,MAAM,CAAGH,MAAM,CAACN,KAAD,CAAT,mBAAZ,CASA,GAAMU,CAAAA,iBAAiB,CAAGJ,MAAM,CAACP,MAAD,CAAT,oBAAvB,CASA,GAAMY,CAAAA,WAAW,CAAGL,MAAM,CAACM,GAAV,oBAAjB,CAMA,GAAMC,CAAAA,aAAa,CAAGP,MAAM,CAACQ,IAAV,oBAAnB,CAKA,cAAe,SAASC,CAAAA,WAAT,EAAuB,CACrC,GAAMC,CAAAA,IAAI,CAAGb,WAAW,CAAC,SAAAc,KAAK,QAAIA,CAAAA,KAAK,CAACC,cAAN,CAAqBC,iBAAzB,EAAN,CAAxB,CACA,GAAMC,CAAAA,QAAQ,CAAGhB,WAAW,EAA5B,CAFqC,gBAGHC,UAAU,CAAC,CAAC,eAAD,CAAD,CAHP,4CAG9BgB,OAH8B,iBAGnBC,YAHmB,iBAKrCxB,KAAK,CAACyB,SAAN,CAAgB,UAAM,SACNC,CAAAA,cADM,oJACrB,4JACKC,MADL,CACcJ,OAAO,CAACK,aADtB,KAEKD,MAFL,+CAGuBE,CAAAA,KAAK,CAAC,sCAAD,CAAyC,CAClEC,OAAO,CAAE,CACR,eAAgB,kBADR,CAERC,aAAa,kBAAYJ,MAAZ,CAFL,CADyD,CAAzC,CAH5B,QAGMK,QAHN,qCASmBA,CAAAA,QAAQ,CAACC,IAAT,EATnB,QASMC,IATN,eAUEZ,QAAQ,CAACb,oBAAoB,CAACyB,IAAD,CAArB,CAAR,CAVF,sDADqB,iDAcrB,GAAI,CACHR,cAAc,GACd,CAAC,MAAOS,GAAP,CAAY,CACbC,OAAO,CAACC,KAAR,CAAcF,GAAd,EACA,CACD,CAnBD,CAmBG,CAACZ,OAAO,CAACK,aAAT,CAAwBN,QAAxB,CAnBH,EAoBA,GAAIJ,IAAJ,CAAU,CACT,MACC,yCACC,oBAAC,IAAD,CAAM,MAAN,EAAa,KAAK,CAAE,CAAEoB,QAAQ,CAAE,OAAZ,CAApB,EACC,oBAAC,iBAAD,EACC,KAAK,CAAC,MADP,CAEC,OAAO,CAAE,kBAAM,CACdd,YAAY,CAAC,eAAD,CAAZ,CACAF,QAAQ,CAACZ,uBAAuB,EAAxB,CAAR,CACA,CALF,EAOC,oBAAC,WAAD,EACC,GAAG,CAAC,oEADL,CAEC,GAAG,CAAC,cAFL,EAPD,CAWC,oBAAC,aAAD,eAXD,CADD,CADD,CAgBC,oBAAC,IAAD,CAAM,MAAN,EAAa,KAAK,CAAE,CAApB,CAAuB,KAAK,CAAE,CAAE6B,SAAS,CAAE,QAAb,CAA9B,EACC,oBAAC,MAAD,EACC,SAAS,CAAC,gBADX,CAEC,EAAE,CAAC,QAFJ,CAGC,GAAG,6CAAuCrB,IAAI,CAACsB,EAA5C,aAAkDtB,IAAI,CAACuB,MAAvD,QAHJ,EADD,CAhBD,CADD,CA0BA,CA3BD,IA2BO,CACN,MACC,qBAAC,iBAAD,EACC,KAAK,CAAC,MADP,CAEC,IAAI,CAAEC,MAAM,CAACC,aAAP,CAAuB,qBAF9B,EAIC,oBAAC,WAAD,EACC,GAAG,CAAC,oEADL,CAEC,GAAG,CAAC,cAFL,EAJD,CAQC,oBAAC,aAAD,cARD,CADD,CAYA,CACD","sourcesContent":["import React from \"react\"\nimport { Button, Image, Grid, Icon } from \"semantic-ui-react\"\nimport { useSelector, useDispatch } from \"react-redux\"\nimport { useCookies } from \"react-cookie\"\nimport styled from \"styled-components\"\nimport {\n\tgetDiscordUserObject,\n\tdeleteDiscordUserObject,\n} from \"../../redux/actions/discordApiActions\"\n\nconst Avatar = styled(Image)`\n\t&&&&&& {\n\t\tborder-radius: 50%;\n\t\tmax-width: 40px;\n\t\theight: auto;\n\t\t// margin-left: 6em;\n\t}\n`\n\nconst LoginLogoutButton = styled(Button)`\n\t&&& {\n\t\tbackground-color: #7289da;\n\t\tcolor: #fff;\n\t\tmin-height: 40px;\n\t\tmin-width: 160px;\n\t}\n`\n\nconst DiscordLogo = styled.img`\n\tmax-width: 35px;\n\theight: auto;\n\tfloat: left;\n`\n\nconst TextAlignment = styled.span`\n\tfont-size: 16px;\n\tline-height: 2em;\n`\n\nexport default function DiscordAuth() {\n\tconst user = useSelector(state => state.discordReducer.discordUserObject)\n\tconst dispatch = useDispatch()\n\tconst [cookies, , removeCookie] = useCookies([\"discord_token\"])\n\n\tReact.useEffect(() => {\n\t\tasync function getDiscordUser() {\n\t\t\tlet dToken = cookies.discord_token\n\t\t\tif (dToken) {\n\t\t\t\tlet response = await fetch(\"https://discordapp.com/api/users/@me\", {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\tAuthorization: `Bearer ${dToken}`,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tlet data = await response.json()\n\t\t\t\tdispatch(getDiscordUserObject(data))\n\t\t\t}\n\t\t}\n\t\ttry {\n\t\t\tgetDiscordUser()\n\t\t} catch (err) {\n\t\t\tconsole.error(err)\n\t\t}\n\t}, [cookies.discord_token, dispatch])\n\tif (user) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Grid.Column style={{ minWidth: \"160px\" }}>\n\t\t\t\t\t<LoginLogoutButton\n\t\t\t\t\t\tcolor=\"blue\"\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tremoveCookie(\"discord_token\")\n\t\t\t\t\t\t\tdispatch(deleteDiscordUserObject())\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DiscordLogo\n\t\t\t\t\t\t\tsrc=\"https://discordapp.com/assets/1c8a54f25d101bdc607cec7228247a9a.svg\"\n\t\t\t\t\t\t\talt=\"discord icon\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<TextAlignment>Logout</TextAlignment>\n\t\t\t\t\t</LoginLogoutButton>\n\t\t\t\t</Grid.Column>\n\t\t\t\t<Grid.Column width={2} style={{ textAlign: \"center\" }}>\n\t\t\t\t\t<Avatar\n\t\t\t\t\t\tclassName=\"discord-avatar\"\n\t\t\t\t\t\tid=\"avatar\"\n\t\t\t\t\t\tsrc={`http://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`}\n\t\t\t\t\t/>\n\t\t\t\t</Grid.Column>\n\t\t\t</>\n\t\t)\n\t} else {\n\t\treturn (\n\t\t\t<LoginLogoutButton\n\t\t\t\tcolor=\"blue\"\n\t\t\t\thref={window.REACT_APP_URL + \"/api/discord/login/\"}\n\t\t\t>\n\t\t\t\t<DiscordLogo\n\t\t\t\t\tsrc=\"https://discordapp.com/assets/1c8a54f25d101bdc607cec7228247a9a.svg\"\n\t\t\t\t\talt=\"discord icon\"\n\t\t\t\t/>\n\t\t\t\t<TextAlignment>Login</TextAlignment>\n\t\t\t</LoginLogoutButton>\n\t\t)\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}